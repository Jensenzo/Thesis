figure1 = figure('PaperType','<custom>','PaperSize',[20 10],'PaperPosition',[0.15 0 20 10.1])
axes1 = axes('Parent',figure1,'XTick',[1 2 3],...
    'Position',[0.087 0.135 0.775 0.78]);

%subplot for S-S
%M=250, q=5
    load PCAMLMAPperformS-S_DATA correct correct_mv correct_ML wrong wrong_ML wrong_mv
    subplot(1,4,1); bar1=bar([...
        [correct_ML(1,13);correct(1,13);correct_mv(1,13)],...
        [wrong_ML(1,13);wrong(1,13);wrong_mv(1,13)],...
        [ones(size(correct_ML(1,13)))-correct_ML(1,13)-wrong_ML(1,13);...
        ones(size(correct(1,13)))-correct(1,13)-wrong(1,13);...
        ones(size(correct_mv(1,13)))-correct_mv(1,13)-wrong_mv(1,13)],...
        ],'stack');
    clear correct correct_mv correct_ML wrong wrong_ML wrong_mv
    xlim(gca,[0.5 3.5]);
    xlabel('Number of components')
ylabel('Ratio of all taps')
title('Training: S; Testing: S')

    
%subplot for S-N
%M=250, q=5
    load PCAMLMAPperformS-N_DATA
    subplot(1,4,2); bar2=bar([...
        [correct_ML(5,13);correct(5,13);correct_mv(5,13)],...
        [wrong_ML(5,13);wrong(5,13);wrong_mv(5,13)],...
        [ones(size(correct_ML(5,13)))-correct_ML(5,13)-wrong_ML(5,13);...
        ones(size(correct(5,13)))-correct(5,13)-wrong(5,13);...
        ones(size(correct_mv(5,13)))-correct_mv(5,13)-wrong_mv(5,13)],...
        ],'stack');
    clear correct correct_mv correct_ML wrong wrong_ML wrong_mv
    xlim(gca,[0.5 3.5]);
    title('Training: S; Testing: N')

%subplot for SN-SN
%M=250, q=5
    load PCAMLMAPperformSN-SN_DATA
    subplot(1,4,3);  bar3=bar([...
        [correct_ML(1,13);correct(1,13);correct_mv(1,13)],...
        [wrong_ML(1,13);wrong(1,13);wrong_mv(1,13)],...
        [ones(size(correct_ML(1,13)))-correct_ML(1,13)-wrong_ML(1,13);...
        ones(size(correct(1,13)))-correct(1,13)-wrong(1,13);...
        ones(size(correct_mv(1,13)))-correct_mv(1,13)-wrong_mv(1,13)],...
        ],'stack');
    clear correct correct_mv correct_ML wrong wrong_ML wrong_mv
    xlim(gca,[0.5 3.5]);
    title('Training: S+N; Testing: S+N')


%subplot for SN-S/N
%M=250, q=5
    load PCAMLMAPperformSN-S_DATA
    subplot(1,4,4);  bar4=bar([...
        [correct_ML(1,13);correct(1,13);correct_mv(1,13)],...
        [wrong_ML(1,13);wrong(1,13);wrong_mv(1,13)],...
        [ones(size(correct_ML(1,13)))-correct_ML(1,13)-wrong_ML(1,13);...
        ones(size(correct(1,13)))-correct(1,13)-wrong(1,13);...
        ones(size(correct_mv(1,13)))-correct_mv(1,13)-wrong_mv(1,13)],...
        ],'stack');
    clear correct correct_mv correct_ML wrong wrong_ML wrong_mv
    xlim(gca,[0.5 3.5]);
    title('Training: S+N; Testing: S')
%%
set(bar1(1),...
    'FaceColor',[0.831372559070587 0.815686285495758 0.7843137383461],...
    'DisplayName','Correct classification');
set(bar1(2),...
    'FaceColor',[0.24705882370472 0.24705882370472 0.24705882370472],...
    'DisplayName','Missed detection');
set(bar1(3),...
    'FaceColor',[0.501960813999176 0.501960813999176 0.501960813999176],...
    'DisplayName','Misclassification');

set(bar2(1),...
    'FaceColor',[0.831372559070587 0.815686285495758 0.7843137383461],...
    'DisplayName','Correct classification');
set(bar2(2),...
    'FaceColor',[0.24705882370472 0.24705882370472 0.24705882370472],...
    'DisplayName','Missed detection');
set(bar2(3),...
    'FaceColor',[0.501960813999176 0.501960813999176 0.501960813999176],...
    'DisplayName','Misclassification');

set(bar3(1),...
    'FaceColor',[0.831372559070587 0.815686285495758 0.7843137383461],...
    'DisplayName','Correct classification');
set(bar3(2),...
    'FaceColor',[0.24705882370472 0.24705882370472 0.24705882370472],...
    'DisplayName','Missed detection');
set(bar3(3),...
    'FaceColor',[0.501960813999176 0.501960813999176 0.501960813999176],...
    'DisplayName','Misclassification');

set(bar4(1),...
    'FaceColor',[0.831372559070587 0.815686285495758 0.7843137383461],...
    'DisplayName','Correct classification');
set(bar4(2),...
    'FaceColor',[0.24705882370472 0.24705882370472 0.24705882370472],...
    'DisplayName','Missed detection');
set(bar4(3),...
    'FaceColor',[0.501960813999176 0.501960813999176 0.501960813999176],...
    'DisplayName','Misclassification');



% Create legend
legend1=legend(gca,'show');
set(legend1,...
    'Position',[0.750574043577721 0.804409029763818 0.226722925457102 0.164408310749774]);

%%
set(gcf,'PaperSize',[20.7 10],'PaperPosition',[0.05 0 20.4 10.1])
print -dpdf PCAMLMAPperform
